<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT ê²½í’ˆ ì¶”ì²¨ê¸°</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti Effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; }
        
        .slot-machine-text {
            animation: bounce 0.5s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* ìˆ«ì ì…ë ¥ì°½ í™”ì‚´í‘œ ìˆ¨ê¸°ê¸° (ê¹”ë”í•œ ë””ìì¸ì„ ìœ„í•´) */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center p-4">

    <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl w-full max-w-md overflow-hidden border border-white/20">
        <!-- Header -->
        <div class="bg-indigo-600 p-6 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
            <h1 class="text-2xl font-bold text-white relative z-10 flex items-center justify-center gap-2">
                <i data-lucide="gift" class="w-6 h-6"></i>
                IT ê²½í’ˆ ì¶”ì²¨ ì´ë²¤íŠ¸
            </h1>
            <p class="text-indigo-200 text-sm mt-2 relative z-10">ë²„íŠ¼ì„ ëˆŒëŸ¬ í–‰ìš´ì„ í™•ì¸í•˜ì„¸ìš”!</p>
        </div>

        <!-- Main Display Area -->
        <div class="p-8 text-center space-y-6">
            <div id="display-area" class="h-32 flex items-center justify-center bg-slate-50 rounded-2xl border-2 border-indigo-100 shadow-inner relative overflow-hidden group">
                <div class="absolute inset-0 bg-indigo-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                <span id="result-text" class="text-3xl font-extrabold text-slate-700 break-keep px-4 relative z-10">
                    Ready?
                </span>
            </div>

            <!-- Buttons -->
            <div class="grid grid-cols-4 gap-3">
                <button id="draw-btn" onclick="startDraw()" class="cursor-pointer col-span-3 bg-indigo-600 hover:bg-indigo-700 active:scale-95 transition-all text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-500/30 text-lg flex items-center justify-center gap-2">
                    <i data-lucide="play" class="w-5 h-5 fill-current"></i>
                    ì¶”ì²¨ ì‹œì‘
                </button>
                <button id="reset-btn" onclick="resetData()" class="cursor-pointer col-span-1 bg-slate-200 hover:bg-slate-300 active:scale-95 transition-all text-slate-600 font-bold py-4 rounded-xl flex items-center justify-center" title="ì´ˆê¸°í™”">
                    <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                </button>
            </div>
        </div>

        <!-- Inventory List -->
        <div class="bg-slate-50 p-6 border-t border-slate-100">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider">ë‚¨ì€ ìˆ˜ëŸ‰ í˜„í™©</h3>
                <span id="total-count" class="text-xs font-medium bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full">Total: 0</span>
            </div>
            
            <div id="inventory-list" class="space-y-3">
                <!-- Javascript will populate this -->
            </div>
            <p class="text-xs text-slate-400 text-center mt-4">ğŸ’¡ ìˆ«ì ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ì—¬ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

<script>
    // 1. ë°ì´í„° ì„¤ì •
    const initialData = [
        { id: 1, name: "ë¯¸ë‹ˆê°í‹°ìŠˆ", total: 36, color: "bg-blue-100 text-blue-700 border-blue-200 ring-blue-200" },
        { id: 2, name: "MBTI í‚¤ë§", total: 48, color: "bg-purple-100 text-purple-700 border-purple-200 ring-purple-200" },
        { id: 3, name: "í‚¤ë³´ë“œ í‚¤ë§", total: 19, color: "bg-pink-100 text-pink-700 border-pink-200 ring-pink-200" },
        { id: 4, name: "IT ìŠ¤í‹°ì»¤", total: 19, color: "bg-green-100 text-green-700 border-green-200 ring-green-200" }
    ];

    // ìƒíƒœ ë³€ìˆ˜
    let prizes = [];
    let isAnimating = false;

    // DOM ìš”ì†Œ
    const displayEl = document.getElementById('result-text');
    const listEl = document.getElementById('inventory-list');
    const drawBtn = document.getElementById('draw-btn');
    const totalCountEl = document.getElementById('total-count');

    // 2. ì´ˆê¸°í™” í•¨ìˆ˜
    function init() {
        // ê¹Šì€ ë³µì‚¬ë¡œ ì´ˆê¸°í™”
        prizes = JSON.parse(JSON.stringify(initialData)).map(item => ({
            ...item,
            current: item.total
        }));
        renderInventory();
        displayEl.innerText = "Ready?";
        displayEl.classList.remove("text-indigo-600", "scale-110");
        displayEl.classList.add("text-slate-700");
    }

    // 3. ë Œë”ë§ í•¨ìˆ˜ (ì§ì ‘ ì…ë ¥ ê°€ëŠ¥í•œ Input ë°©ì‹)
    function renderInventory() {
        let totalLeft = 0;
        
        const listHTML = prizes.map(item => {
            totalLeft += item.current;
            
            // ì§„í–‰ë¥  ê³„ì‚°
            let percent = (item.current / item.total) * 100;
            if (percent > 100) percent = 100;
            if (isNaN(percent)) percent = 0;

            const isSoldOut = item.current === 0;

            return `
                <div class="relative overflow-hidden bg-white border ${isSoldOut ? 'border-slate-200 opacity-70' : 'border-slate-200'} rounded-xl p-3 shadow-sm transition-all hover:shadow-md">
                    <div class="flex justify-between items-center relative z-10">
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-bold ${isSoldOut ? 'text-slate-400 line-through' : 'text-slate-700'}">${item.name}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-xs text-slate-400 mr-1">ë‚¨ì€ìˆ˜ëŸ‰:</span>
                            <!-- ì§ì ‘ ì…ë ¥ ê°€ëŠ¥í•œ Input í•„ë“œ -->
                            <input 
                                type="number" 
                                value="${item.current}" 
                                min="0"
                                onchange="updateCount(${item.id}, this.value)"
                                class="text-center font-bold text-sm w-16 px-1 py-1 rounded-md border border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all ${isSoldOut ? 'bg-slate-100 text-slate-400' : 'bg-white text-slate-700'}"
                            >
                            <span class="text-xs text-slate-400">ê°œ</span>
                        </div>
                    </div>
                    <!-- Progress Bar Background -->
                    <div class="absolute bottom-0 left-0 h-1 bg-slate-100 w-full z-0">
                        <div class="h-full ${item.color.split(' ')[0].replace('bg-', 'bg-')}" style="width: ${percent}%; opacity: 0.5;"></div>
                    </div>
                </div>
            `;
        }).join('');

        listEl.innerHTML = listHTML;
        totalCountEl.innerText = `ë‚¨ì€ ìˆ˜ëŸ‰: ${totalLeft}`;
        lucide.createIcons();
        
        if (totalLeft === 0) {
            drawBtn.disabled = true;
            drawBtn.innerHTML = "ğŸš« ì¢…ë£Œë¨";
            drawBtn.classList.add("opacity-50", "cursor-not-allowed");
            drawBtn.classList.remove("cursor-pointer", "hover:bg-indigo-700", "shadow-lg");
            displayEl.innerText = "ëª¨ë“  ê²½í’ˆì´ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤!";
        } else {
            drawBtn.disabled = false;
            drawBtn.innerHTML = '<i data-lucide="play" class="w-5 h-5 fill-current"></i> ì¶”ì²¨ ì‹œì‘';
            drawBtn.classList.remove("opacity-50", "cursor-not-allowed");
            drawBtn.classList.add("cursor-pointer", "hover:bg-indigo-700", "shadow-lg");
            lucide.createIcons();
        }
    }

    // 3.5 ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (Input ë³€ê²½ ì‹œ ì¦‰ì‹œ ë°˜ì˜)
    window.updateCount = function(id, value) {
        // ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì—ëŠ” ìˆ˜ì • ë°©ì§€ ì•Œë¦¼
        if (isAnimating) {
            alert("ì¶”ì²¨ ì¤‘ì—ëŠ” ìˆ˜ëŸ‰ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            renderInventory(); // ì›ë˜ ê°’ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° ìœ„í•´ ì¬ë Œë”ë§
            return;
        }

        const item = prizes.find(p => p.id === id);
        if (!item) return;

        let newCount = parseInt(value, 10);
        
        // ìœ íš¨ì„± ê²€ì‚¬
        if (isNaN(newCount) || newCount < 0) {
            newCount = 0;
        }

        // ê°’ ì—…ë°ì´íŠ¸
        item.current = newCount;
        
        // ë§Œì•½ í˜„ì¬ ìˆ˜ëŸ‰ì´ ì „ì²´ ìš©ëŸ‰ë³´ë‹¤ ì»¤ì§€ë©´ ìš©ëŸ‰ë„ ëŠ˜ë ¤ì¤Œ (ê·¸ë˜í”„ ë¹„ìœ¨ ìœ ì§€)
        if (newCount > item.total) {
            item.total = newCount;
        }
        
        // í™”ë©´ ê°±ì‹  (ì´ ê°œìˆ˜ ì—…ë°ì´íŠ¸ ë“±ì„ ìœ„í•´)
        renderInventory();
    };

    // 4. ì¶”ì²¨ ë¡œì§
    function startDraw() {
        if (isAnimating) return;
        
        const availableTypes = prizes.filter(p => p.current > 0);
        if (availableTypes.length === 0) return;

        isAnimating = true;
        drawBtn.disabled = true;
        drawBtn.classList.add("opacity-50", "cursor-not-allowed");
        
        // ë¡¤ë§ ì• ë‹ˆë©”ì´ì…˜
        let frameCount = 0;
        const maxFrames = 25; 
        const interval = setInterval(() => {
            const randomTemp = availableTypes[Math.floor(Math.random() * availableTypes.length)];
            displayEl.innerText = randomTemp.name;
            displayEl.classList.remove("scale-110", "text-indigo-600");
            
            frameCount++;
            if (frameCount >= maxFrames) {
                clearInterval(interval);
                selectWinner();
            }
        }, 80); 
    }

    function selectWinner() {
        const totalRemaining = prizes.reduce((acc, cur) => acc + cur.current, 0);
        let randomNum = Math.floor(Math.random() * totalRemaining) + 1;
        
        let selectedItem = null;
        
        for (let item of prizes) {
            if (item.current > 0) {
                randomNum -= item.current;
                if (randomNum <= 0) {
                    selectedItem = item;
                    break;
                }
            }
        }

        if (selectedItem) {
            selectedItem.current--;
            
            displayEl.innerText = `ğŸ‰ ${selectedItem.name} ğŸ‰`;
            displayEl.classList.add("text-indigo-600", "scale-110", "transition-transform");
            
            renderInventory();
            fireConfetti();
        }

        isAnimating = false;
        
        if (prizes.reduce((acc, cur) => acc + cur.current, 0) > 0) {
            drawBtn.disabled = false;
            drawBtn.classList.remove("opacity-50", "cursor-not-allowed");
        }
    }

    // 5. ì´ˆê¸°í™” ë²„íŠ¼
    function resetData() {
        if (confirm("ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸° ì„¤ì •ê°’ìœ¼ë¡œ ë˜ëŒë¦´ê¹Œìš”?")) {
            confetti({
                particleCount: 50,
                spread: 70,
                origin: { y: 0.8 },
                colors: ['#cccccc']
            });
            init();
        }
    }

    // 6. í­ì£½ íš¨ê³¼
    function fireConfetti() {
        const count = 200;
        const defaults = {
            origin: { y: 0.7 },
            zIndex: 9999
        };

        function fire(particleRatio, opts) {
            confetti(Object.assign({}, defaults, opts, {
                particleCount: Math.floor(count * particleRatio)
            }));
        }

        fire(0.25, { spread: 26, startVelocity: 55 });
        fire(0.2, { spread: 60 });
        fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
        fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
        fire(0.1, { spread: 120, startVelocity: 45 });
    }

    init();

</script>
</body>
</html>